#"Bus stop"     = 0.02
)
# Optional: verify all levels are covered
#setdiff(levels(stations_sf$type), names(station_cols))
#setdiff(levels(roads_sf$type), names(road_cols))
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","top")) +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
library(dplyr)
library(sf)
library(tmap)
library(stringr)
roads_sf <- bind_rows(
motorveje       %>% mutate(type = "Motorway"),
motortrafikveje %>% mutate(type = "Trunk / motortrafikvej"),
landeveje       %>% mutate(type = "Primary / landevej")
#byveje          %>% mutate(type = "Byvej")
) %>%
mutate(type = str_trim(type)) %>%
filter(!is.na(type)) %>%
mutate(type = factor(type, levels = c(
"Motorway", "Trunk / motortrafikvej", "Primary / landevej"#, "Byvej"
))) %>%
mutate(type = droplevels(type))
stations_sf <- bind_rows(
brandstationer %>% mutate(type = "Fire station"),
busstationer   %>% mutate(type = "Bus station")
#busstop        %>% mutate(type = "Bus stop")
) %>%
mutate(type = str_trim(type)) %>%
filter(!is.na(type)) %>%
mutate(type = factor(type, levels = c(
"Fire station", "Bus station"#, "Bus stop"
))) %>%
mutate(type = droplevels(type))
road_cols <- c(
"Motorway" = "orange",
"Trunk / motortrafikvej" = "blue",
"Primary / landevej" = "cyan2"
#"Byvej" = "lightblue"
)
station_cols <- c(
"Fire station" = "red",
"Bus station"  = "purple"
#"Bus stop"     = "magenta2"
)
# Line widths per road type
road_lwd <- c(
"Motorway" = 2,
"Trunk / motortrafikvej" = 1,
"Primary / landevej" = 0.75
#"Byvej" = 0.4
)
# Dot sizes per station type (Denmark-scale: bus stops must be tiny!)
station_size <- c(
"Fire station" = 0.12,
"Bus station"  = 0.07
#"Bus stop"     = 0.02
)
# Optional: verify all levels are covered
#setdiff(levels(stations_sf$type), names(station_cols))
#setdiff(levels(roads_sf$type), names(road_cols))
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","top")) +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 2000, height = 1500, units = "px", dpi = 300
)
road_cols <- c(
"Motorway" = "orange",
"Trunk / motortrafikvej" = "blue",
"Primary / landevej" = "cyan2"
#"Byvej" = "lightblue"
)
station_cols <- c(
"Fire station" = "red",
"Bus station"  = "purple"
#"Bus stop"     = "magenta2"
)
# Line widths per road type
road_lwd <- c(
"Motorway" = 2,
"Trunk / motortrafikvej" = 1,
"Primary / landevej" = 0.75
#"Byvej" = 0.4
)
# Dot sizes per station type (Denmark-scale: bus stops must be tiny!)
station_size <- c(
"Fire station" = 0.30,
"Bus station"  = 0.15
#"Bus stop"     = 0.02
)
# Optional: verify all levels are covered
#setdiff(levels(stations_sf$type), names(station_cols))
#setdiff(levels(roads_sf$type), names(road_cols))
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","top")) +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 2000, height = 1500, units = "px", dpi = 300
)
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","top")) +
tm_credits(text = "N. Engedal, 18th of February 2026") +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 2000, height = 1500, units = "px", dpi = 300
)
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 3840, height = 2160, units = "px", dpi = 600
)
# points
helikopter <- st_read("data/Helikopterlandingspladser_DK/infrastruktur_helipad.geojson")
library(dplyr)
library(sf)
library(tmap)
library(stringr)
roads_sf <- bind_rows(
motorveje       %>% mutate(type = "Motorway"),
motortrafikveje %>% mutate(type = "Trunk / motortrafikvej"),
landeveje       %>% mutate(type = "Primary / landevej")
#byveje          %>% mutate(type = "Byvej")
) %>%
mutate(type = str_trim(type)) %>%
filter(!is.na(type)) %>%
mutate(type = factor(type, levels = c(
"Motorway", "Trunk / motortrafikvej", "Primary / landevej"#, "Byvej"
))) %>%
mutate(type = droplevels(type))
stations_sf <- bind_rows(
brandstationer %>% mutate(type = "Fire station"),
busstationer   %>% mutate(type = "Bus station"),
helikopter %>% mutate(type = "Helikopter")
#busstop        %>% mutate(type = "Bus stop")
) %>%
mutate(type = str_trim(type)) %>%
filter(!is.na(type)) %>%
mutate(type = factor(type, levels = c(
"Fire station", "Bus station", "Helikopter"#, "Bus stop"
))) %>%
mutate(type = droplevels(type))
road_cols <- c(
"Motorway" = "orange",
"Trunk / motortrafikvej" = "blue",
"Primary / landevej" = "cyan2"
#"Byvej" = "lightblue"
)
station_cols <- c(
"Fire station" = "red",
"Bus station"  = "purple",
"Helikopter" = "green"
#"Bus stop"     = "magenta2"
)
# Line widths per road type
road_lwd <- c(
"Motorway" = 2,
"Trunk / motortrafikvej" = 1,
"Primary / landevej" = 0.75
#"Byvej" = 0.4
)
# Dot sizes per station type (Denmark-scale: bus stops must be tiny!)
station_size <- c(
"Fire station" = 0.30,
"Bus station"  = 0.15,
"Helikopter" = 0.30
#"Bus stop"     = 0.02
)
# Optional: verify all levels are covered
#setdiff(levels(stations_sf$type), names(station_cols))
#setdiff(levels(roads_sf$type), names(road_cols))
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","top")) +
tm_credits(text = "N. Engedal, 18th of February 2026") +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 3840, height = 2160, units = "px", dpi = 600
)
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","bottom")) +
tm_credits(text = "N. Engedal, 18th of February 2026") +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 3840, height = 2160, units = "px", dpi = 600
)
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","bottom")) +
tm_credits(text = "N. Engedal, 18th of February 2026", position=c("RIGHT", "top")) +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 3840, height = 2160, units = "px", dpi = 600
)
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","bottom")) +
tm_credits(text = "N. Engedal, 18th of February 2026", position=c("LEFT", "top")) +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 3840, height = 2160, units = "px", dpi = 600
)
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","bottom")) +
tm_credits(text = "N. Engedal, 18th of February 2026", position=c("RIGHT", "center")) +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 3840, height = 2160, units = "px", dpi = 600
)
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","bottom")) +
tm_credits(text = "N. Engedal, 18th of February 2026", position=c(1.2, 0.99)) +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 3840, height = 2160, units = "px", dpi = 600
)
tm_shape(DK_border) +
tm_borders(lwd = 2) +
tm_shape(roads_sf) +
tm_lines(
col = "type",
col.scale = tm_scale_categorical(values = road_cols),
lwd = "type",
lwd.scale = tm_scale_categorical(values = road_lwd),
lwd.legend = tm_legend_hide(),
col.legend = tm_legend(title = "Road type")
) +
tm_shape(stations_sf) +
tm_dots(
fill = "type",  # <-- key change
fill.scale = tm_scale_categorical(values = station_cols),
fill.legend = tm_legend(title = "Stations"),
size = "type",
size.scale = tm_scale_categorical(values = station_size),
size.legend = tm_legend_hide(),
col = "black",  # optional: outline color
lwd = 0.2       # optional: outline width
) +
tm_compass(position = c("RIGHT","bottom"), type = "arrow", size = 1) +
tm_scalebar(position = c("RIGHT","bottom")) +
tm_credits(text = "N. Engedal, 18th of February 2026", position=c(1, 0.5)) +
tm_title("Infrastructure in Denmark") +
tm_layout(bg.color = "white", frame = FALSE)
# Save the map in high res in output dir
tmap_save(
filename = "output/denmark_infrastructure.png",
width = 3840, height = 2160, units = "px", dpi = 600
)
# get municipalities
muns <- readRDS("../data/gadm36_DNK_2_sp.rds") %>%
st_as_sf()
# get votes
library(googlesheets4)
gs4_deauth()
votes <- read_sheet("https://docs.google.com/spreadsheets/d/1R77xvSEdEF5UMF6u1POlHVyYHbB1zFkNqEYTkwD7GPw/edit?")
# align municipality names
`%nin%` <- Negate(`%in%`)
votes$Division %in% muns$NAME_2
votes$Division[votes$Division %nin% muns$NAME_2]
muns$NAME_2[31] <- "Aarhus"
muns$NAME_2[21] <- "HÃ¸je-Taastrup"
muns$NAME_2[25] <- "Copenhagen"
# join up
mun_vote <- muns %>%
select(NAME_2) %>%
left_join(votes, by = c("NAME_2"="Division"))
mun_vote
